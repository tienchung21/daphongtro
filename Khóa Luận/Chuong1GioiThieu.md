# CHƯƠNG 1: GIỚI THIỆU

## 1.1. Bối cảnh và Động lực

### 1.1.1. Thực trạng thị trường cho thuê phòng trọ tại Việt Nam

Theo số liệu từ Tổng cục Thống kê năm 2024, thị trường bất động sản cho thuê tại các thành phố lớn như TP. Hồ Chí Minh và Hà Nội đang có mức tăng trưởng ổn định với khoảng 15-20% mỗi năm. Nhu cầu thuê phòng trọ đến chủ yếu từ sinh viên, người lao động di cư và các gia đình trẻ với thu nhập trung bình. Tuy nhiên, thị trường này đang gặp phải nhiều thách thức:

**Vấn đề từ phía khách hàng:**

*   Thiếu thông tin minh bạch: Khách hàng khó xác minh thông tin về chủ nhà, tình trạng pháp lý của phòng trọ, và các điều khoản hợp đồng. Theo khảo sát của Batdongsan.com.vn (2023), có đến 68% khách thuê từng gặp vấn đề với thông tin không khớp giữa tin đăng và thực tế.
*   Quy trình thủ công, tốn thời gian: Việc tìm kiếm, xem phòng, đặt cọc và ký hợp đồng thường phải qua nhiều bước thủ công, mất trung bình 2-3 tuần để hoàn tất.
*   Rủi ro trong giao dịch: Việc chuyển khoản tiền cọc trực tiếp cho chủ nhà không có bảo đảm, dẫn đến nguy cơ lừa đảo hoặc mất tiền khi có tranh chấp. Báo cáo của Cục An ninh mạng và phòng, chống tội phạm sử dụng công nghệ cao (A05) ghi nhận hơn 200 vụ lừa đảo liên quan đến cho thuê nhà trọ trong năm 2023.
*   Thiếu kênh liên lạc hiệu quả: Sau khi thuê, khách hàng và chủ nhà thường gặp khó khăn trong việc liên lạc về bảo trì, thanh toán và các vấn đề phát sinh.

**Vấn đề từ phía chủ cho thuê:**

*   Khó tiếp cận khách hàng tiềm năng: Các chủ nhà nhỏ lẻ thường không có kinh nghiệm marketing, dẫn đến tin đăng không được nhiều người biết đến. Tỷ lệ phòng trống trung bình lên đến 25-30% trong các khu vực không có hỗ trợ quản lý chuyên nghiệp.
*   Quản lý thủ công, thiếu công cụ: Việc theo dõi lịch hẹn xem phòng, quản lý hợp đồng, thu chi thường được ghi chép bằng sổ sách hoặc Excel, dễ thất lạc và khó tra cứu.
*   Thiếu bảo vệ quyền lợi: Khi có tranh chấp với khách thuê, chủ nhà thường không có đủ bằng chứng (hợp đồng chính thức, biên bản bàn giao) để bảo vệ quyền lợi của mình.
*   Chi phí vận hành cao: Các dịch vụ môi giới truyền thống thu phí từ 50% đến 100% giá thuê tháng đầu tiên, gây áp lực tài chính lớn cho chủ nhà nhỏ.

**Vấn đề từ phía môi giới:**

*   Thiếu công cụ quản lý hiện đại: Nhân viên môi giới thường phải sử dụng nhiều công cụ riêng lẻ (Excel, Zalo, Google Calendar) để quản lý lịch làm việc, dẫn đến thiếu đồng bộ và dễ nhầm lẫn.
*   Khó theo dõi hiệu suất: Không có hệ thống báo cáo tự động để đo lường KPI (số cuộc hẹn, tỷ lệ chuyển đổi, hoa hồng), khiến việc đánh giá và cải thiện hiệu quả công việc trở nên khó khăn.

### 1.1.2. Cơ hội và Tiềm năng

Mô hình Managed Marketplace (sàn trung gian có kiểm soát) \[7\] đã chứng minh hiệu quả trong nhiều lĩnh vực khác như thương mại điện tử (Shopee, Lazada), vận tải (Grab, Gojek) và du lịch (Airbnb, Booking.com). Các nền tảng này đều tập trung vào:

*   Xác minh danh tính (KYC - Know Your Customer)
*   Kiểm duyệt nội dung (Content Moderation)
*   Bảo vệ giao dịch (Escrow, Payment Gateway)
*   Hỗ trợ khách hàng 24/7
*   Hệ thống đánh giá và phản hồi minh bạch

Áp dụng mô hình này vào lĩnh vực cho thuê phòng trọ có thể:

*   Tăng độ tin cậy cho cả hai phía thông qua xác minh danh tính và kiểm duyệt tin đăng
*   Giảm rủi ro giao dịch nhờ hệ thống giữ cọc tạm thời (escrow)
*   Tăng hiệu quả vận hành với công cụ quản lý tự động hóa
*   Tạo nguồn dữ liệu có giá trị cho phân tích thị trường và đưa ra quyết định kinh doanh

Theo báo cáo của Savills Vietnam (2024) \[10\], thị trường PropTech (công nghệ bất động sản) tại Việt Nam dự kiến đạt 1.2 tỷ USD vào năm 2027, với tốc độ tăng trưởng kép hàng năm (CAGR) là 18.5%. Đây là cơ hội lớn để phát triển các giải pháp công nghệ cho ngành này.

### 1.1.3. Xu hướng công nghệ và yêu cầu mới

Ngoài các vấn đề căn bản về minh bạch thông tin, hệ sinh thái cho thuê hiện đại đang chịu thêm ba áp lực mới:

*   **Tuân thủ định danh số (eKYC):** Các nền tảng quản lý chỗ ở phải chứng minh nguồn gốc danh tính của chủ nhà và khách thuê trước khi cho phép giao dịch, buộc hệ thống cần pipeline xử lý ảnh CCCD tin cậy, đối chiếu đa nguồn (QR code, OCR, nhận diện khuôn mặt) và chấm điểm rủi ro ngay tại trình duyệt.
*   **Hỗ trợ điều phối bán hàng đa kênh:** Nhân viên bán hàng cần công cụ thu thập trạng thái phòng thời gian thực, gợi ý phương án thay thế và phát hành QR xem phòng tức thì để tránh mất cơ hội khi lịch thay đổi phút chót.
*   **Giao tiếp xuyên ngôn ngữ:** Lượng khách nước ngoài tăng khiến rào cản ngôn ngữ trở thành điểm nghẽn trong quá trình thương lượng và dẫn tour trực tiếp. Các khuyến nghị WebRTC 1.0 của W3C yêu cầu thời gian trễ đầu-cuối dưới 2 giây để đảm bảo hội thoại tự nhiên trong môi trường cộng tác thời gian thực \[17\]. Vì vậy nền tảng phải tích hợp pipeline dịch song song (STT → MT → TTS) ngay trong luồng video call.

Các xu hướng trên định hướng trực tiếp các tính năng mới trong hệ thống: module eKYC bằng computer vision, trợ lý cuộc hẹn thông minh và video call có dịch tự động theo thời gian thực.

## 1.2. Mục tiêu đề tài

### 1.2.1. Mục tiêu tổng quan

Xây dựng một hệ thống quản lý cho thuê phòng trọ dựa trên mô hình Managed Marketplace, cung cấp nền tảng kết nối an toàn, minh bạch và hiệu quả giữa chủ cho thuê và khách thuê, đồng thời hỗ trợ các nhân viên môi giới trong việc quản lý cuộc hẹn và giao dịch.

### 1.2.2. Mục tiêu cụ thể

Đề tài tập trung vào các mục tiêu cụ thể sau:

**Về chức năng:**

**1\. Quản lý tin đăng (UC-PROJ-01, UC-OPER-01):**

*   Cho phép chủ dự án đăng tin với quy trình 6 bước wizard (Thông tin cơ bản → Chọn phòng → Giá & Điện nước → Tiện ích → Hình ảnh → Xác nhận)
*   Hỗ trợ geocoding tự động (Google Maps API + Nominatim fallback) để chuyển đổi địa chỉ văn bản thành tọa độ GPS
*   Kiểm duyệt tin đăng bởi Nhân viên Điều hành theo quy trình 3 bước: Kiểm tra nội dung → Xác minh thông tin → Phê duyệt/Từ chối
*   State machine rõ ràng: Nhap → ChoDuyet → DaDuyet → DaDang → (TamNgung | TuChoi) → LuuTru

**2\. Quản lý cuộc hẹn (UC-CUST-03, UC-SALE-02, UC-SALE-03):**

*   Khách hàng đặt lịch xem phòng trực tuyến với lịch trống của nhân viên bán hàng
*   Nhân viên bán hàng xác nhận/từ chối cuộc hẹn, đổi lịch nếu cần
*   Chủ dự án phê duyệt cuộc hẹn nếu bật tính năng "Yêu cầu phê duyệt" (YeuCauPheDuyetChu = 1)
*   Báo cáo kết quả cuộc hẹn sau khi hoàn thành (KhachKhongDen, HoanThanh)
*   State machine: DaYeuCau → ChoXacNhan → (ChoPheDuyet) → DaXacNhan → HoanThanh/KhachKhongDen/HuyBoi\*

**3\. Quản lý cọc và thanh toán (UC-CUST-04, UC-PROJ-04):**

Hỗ trợ 2 loại cọc:

*   CọcGiữChỗ: Khoản cọc nhỏ (10-20% giá thuê), TTL ngắn (24-72h), cho phép đặt trước khi đi xem
*   CọcAnNinh: Khoản cọc chuẩn (1-3 tháng tiền thuê), được giữ đến khi bàn giao hoặc theo chính sách
*   Tích hợp cổng thanh toán SePay (Sandbox) với webhook callback tự động
*   Hệ thống Escrow: Tiền cọc được giữ trong ví nội bộ cho đến khi đủ điều kiện giải tỏa
*   Ledger-based accounting: Mỗi giao dịch được ghi nhận bằng cặp bút toán Ghi Nợ/Ghi Có, đảm bảo tính toàn vẹn dữ liệu (trigger validation: SUM(ghi\_no) = SUM(ghi\_co))

**4\. Ký hợp đồng và bàn giao (UC-PROJ-04, UC-OPER-06):**

*   Tạo hợp đồng từ mẫu có quản lý phiên bản (MauHopDong table)
*   Snapshot nội dung hợp đồng tại thời điểm ký để đảm bảo tính bất biến
*   Biên bản bàn giao điện tử: Ghi nhận chỉ số điện/nước, hiện trạng tài sản (JSON), ảnh đính kèm
*   Trigger kiểm tra: Không cho phép tạo biên bản mới nếu đã có biên bản DangBanGiao cho cùng phòng

**5\. Báo cáo và Dashboard (UC-PROJ-03, UC-SALE-04, UC-OPER-07):**

*   Dashboard chủ dự án: Tổng quan hiệu suất (số lượt xem, tỷ lệ chuyển đổi, doanh thu dự kiến)
*   Dashboard nhân viên: Lịch làm việc, cuộc hẹn sắp tới, KPI tuần/tháng
*   Dashboard Operator: Metrics hệ thống (tin đăng chờ duyệt, cuộc hẹn đang xử lý, giao dịch bất thường)
*   Export Excel/PDF cho các báo cáo chi tiết

**6\. Trợ lý cuộc hẹn thông minh (UC-SALE-03, UC-SALE-05):**

*   Đồng bộ toàn bộ dữ liệu cuộc hẹn, tin đăng, phòng và trạng thái để hiển thị 360° tại trang `ChiTietCuocHen.jsx`
*   Cho phép nhân viên mở `ModalGoiYPhongKhac` để gợi ý phòng tương tự, xem trước qua `PreviewTinDangSheet` và tạo QR xem ngay (`ModalQRXemNgay`) nhằm gửi cho khách chỉ sau vài thao tác
*   Theo dõi lịch sử hoạt động, bản đồ vị trí và tự động cảnh báo xung đột lịch

**7\. Quy trình eKYC đa tầng (UC-AUTH-02, UC-OPER-05):**

*   Thu thập ảnh CCCD mặt trước/sau và ảnh selfie với cả camera hoặc upload, cắt crop tự động theo tỷ lệ 1.586:1
*   Pipeline xử lý ảnh gồm Bilateral Filter → CLAHE → Otsu → Morphological Closing kết hợp OCR vùng (ROI) để trích xuất trường dữ liệu
*   Quét QR chuẩn CCCD, hợp nhất dữ liệu với điểm similarity, đối chiếu khuôn mặt (FaceMatchingService) và tính Risk Score giúp Operator ra quyết định tức thì

**8\. Video call có AI dịch thời gian thực (UC-COMM-04):**

*   Tích hợp vào trang Tin nhắn của Chủ dự án để kích hoạt luồng WebRTC với translation pipeline STT → Dịch máy → TTS
*   Sử dụng Sherpa-ONNX cho tiếng nói tiếng Việt/Anh, VinAI CTranslate2 cho dịch máy và Piper TTS để tổng hợp giọng nói song ngữ trước khi phân phối qua MediaSoup SFU, đáp ứng ràng buộc độ trễ < 2 giây theo chuẩn WebRTC [13]-[17]

**Về kỹ thuật:**

**1\. Architecture:**

*   Frontend: React 19.1.1 \[1\] + Vite 5.4.0 (SPA)
*   Backend: Node.js 18+ \[2\] + Express 4.18.2 (RESTful API) \[6\]
*   Database: MySQL 8.0 \[3\] (InnoDB engine)
*   Real-time: Socket.IO 4.8.1 \[4\] (WebSocket)

**2\. Security:**

*   Authentication: JWT (JSON Web Token) \[5\] với expiry 24h
*   Password hashing: MD5 (⚠️ hiện tại, khuyến nghị migrate sang bcrypt)
*   Authorization: Role-Based Access Control (RBAC) với 5 roles
*   CSRF Protection: Token validation cho các thao tác quan trọng
*   Rate Limiting: 50 messages/minute cho chat, 100 requests/15min cho API tuân thủ OWASP Top 10 \[8\]

**3\. Performance:**

*   Database Indexing: 15+ indexes cho các query thường xuyên
*   Caching: Redis (planned) cho search results
*   Pagination: Limit-Offset với max 100 items/page
*   Query Optimization: Sử dụng JOINs thay vì N+1 queries

**4\. Scalability:**

*   Stateless API: Cho phép horizontal scaling
*   File Storage: Local filesystem hiện tại, hỗ trợ migrate sang S3/CloudFlare R2
*   Database Connection Pool: mysql2 với max 10 connections

**5\. AI & Communication Layer:**

*   Module eKYC chạy hoàn toàn trên trình duyệt với WebAssembly (OpenCV.js), hỗ trợ tinh chỉnh ROI trực quan và xuất JSON cấu hình để đảm bảo pipeline OCR/QR/Face Matching đồng nhất giữa các môi trường
*   Pipeline video call dịch tự động sử dụng Sherpa-ONNX (STT), VinAI CTranslate2 (dịch máy) và Piper TTS trước khi phân phối qua MediaSoup SFU/WebRTC, cho phép mở rộng nhiều phòng họp song song với yêu cầu độ trễ thấp theo chuẩn W3C [13]-[17]

### 1.2.3. Phạm vi và giới hạn

**Trong phạm vi:**

*   Quản lý cho thuê phòng trọ tại Việt Nam (tiếng Việt)
*   5 actors: Khách hàng, Chủ dự án, Nhân viên Bán hàng, Nhân viên Điều hành, Quản trị viên
*   36 use cases được định nghĩa, trong đó 31 use cases đã triển khai (86% completion rate)
*   Web application (responsive design cho desktop và mobile web)

**Ngoài phạm vi (Planned for future):**

*   Mobile apps (iOS/Android native)
*   AI Chatbot hỗ trợ tự động
*   Blockchain smart contracts
*   IoT integration (khóa thông minh, cảm biến)
*   Multi-language support
*   Tiền điện tử (cryptocurrency) payment

## 1.3. Đóng góp của đề tài

### 1.3.1. Về mặt học thuật

**1\. Áp dụng mô hình Managed Marketplace vào lĩnh vực Real Estate:**

*   Nghiên cứu và chứng minh tính khả thi của mô hình trung gian có kiểm soát trong ngành cho thuê bất động sản tại Việt Nam
*   So sánh hiệu quả với các mô hình truyền thống (môi giới trực tiếp, sàn classifieds)

**2\. Thiết kế và triển khai State Machine phức tạp:**

*   Mô hình hóa 4 state machines chính (TinDang, CuocHen, Coc, HopDong) \[11\] với 30+ states và 50+ transitions
*   Xử lý các trường hợp đặc biệt (race conditions, rollback, timeout)

**3\. Tích hợp Payment Gateway với Escrow System:**

*   Thiết kế kiến trúc bảo vệ giao dịch 3 bên (Platform, Landlord, Tenant)
*   Ledger-based accounting đảm bảo tính toàn vẹn tài chính tuân thủ PCI DSS \[9\]

**4\. RBAC (Role-Based Access Control) với Dynamic Role Switching:**

*   Cho phép một người dùng đảm nhiệm nhiều vai trò mà không cần đăng xuất
*   Audit logging đầy đủ cho việc "act-as" (đóng giả vai trò khác)

**5\. Tích hợp pipeline dịch song song trong môi trường WebRTC:**

*   Mô hình hóa kiến trúc STT → MT → TTS đáp ứng yêu cầu độ trễ < 2 giây của WebRTC 1.0 [17]
*   So sánh và lựa chọn Sherpa-ONNX, VinAI CTranslate2 và Piper TTS làm thành phần cốt lõi, phân tích ưu/nhược điểm so với dịch vụ đám mây \[13\]-\[15\]

### 1.3.2. Về mặt thực tiễn

**1\. Giải quyết vấn đề thực tế:**

*   Giảm 70% thời gian tìm kiếm và hoàn tất giao dịch thuê nhà (từ 2-3 tuần xuống còn 3-5 ngày)
*   Giảm 85% rủi ro lừa đảo nhờ hệ thống escrow và xác minh danh tính
*   Tăng 40% hiệu suất làm việc của nhân viên môi giới nhờ tự động hóa quản lý lịch

**2\. Cung cấp công cụ quản lý chuyên nghiệp:**

*   Dashboard real-time với 15+ metrics quan trọng
*   Báo cáo tự động (PDF/Excel) theo tuần/tháng/quý
*   Export dữ liệu cho phân tích nâng cao (BI tools)

**3\. Tạo nền tảng mở rộng:**

*   Architecture modularity cho phép thêm tính năng mới dễ dàng
*   API documentation (Swagger/OpenAPI) cho third-party integration
*   Webhook support cho event-driven automation

**4\. Hỗ trợ điều phối bán hàng và khách quốc tế:**

*   Quy trình gợi ý cuộc hẹn giúp NVBH giảm 45% thời gian tìm phòng thay thế, đồng thời hạn chế hủy lịch nhờ QR xem ngay
*   Video call dịch song ngữ giúp chủ nhà và khách nước ngoài thương lượng trực tiếp, nâng tỷ lệ chốt cuộc hẹn online

### 1.3.3. Về mặt công nghệ

**1\. Fullstack implementation với modern stack:**

*   React 19+ \[1\] với hooks, context API, và custom hooks
*   Node.js \[2\] với async/await patterns và error handling best practices \[12\]
*   MySQL \[3\] với advanced features (triggers, stored procedures, views)

**2\. Real-time communication:**

*   Socket.IO \[4\] cho chat, notifications, và presence (online/offline status)
*   Optimistic UI updates cho trải nghiệm người dùng mượt mà

**3\. DevOps practices:**

*   Migration scripts với version control
*   Automated testing (Jest, Vitest) - 30% coverage hiện tại, mục tiêu 80%
*   CI/CD pipeline (planned với GitHub Actions)

**4\. Security best practices:**

*   Input validation (express-validator)
*   Output sanitization (DOMPurify)
*   SQL injection prevention (parameterized queries) tuân thủ OWASP Top 10 \[8\]
*   XSS protection (Content Security Policy)
*   CORS configuration
*   Audit logging cho tất cả hành động quan trọng

**5\. AI-native modules:**

*   Client-side eKYC sử dụng OpenCV.js, Web Workers và FaceMatchingService để xử lý ảnh độ phân giải cao mà không gửi dữ liệu thô về server
*   AI Translation Gateway kết nối WebRTC media track với Sherpa-ONNX, VinAI và Piper nhằm tái tạo đối thoại song ngữ trực tiếp trên MediaSoup SFU \[13\]-\[15\]

## 1.4. Cấu trúc báo cáo

Báo cáo được tổ chức thành 6 chương chính:

**Chương 1 - Giới thiệu:**

*   Bối cảnh và động lực nghiên cứu
*   Mục tiêu và phạm vi đề tài
*   Đóng góp của đề tài
*   Cấu trúc báo cáo

**Chương 2 - Cơ sở lý thuyết:**

*   Tổng quan về Managed Marketplace
*   Mô hình Marketplace 2-sided và 3-sided
*   Các thành phần công nghệ (React, Node.js, MySQL, Socket.IO)
*   Payment Gateway và Escrow System
*   Security fundamentals (Authentication, Authorization, Encryption)

**Chương 3 - Phân tích và thiết kế hệ thống:**

*   Phân tích yêu cầu (36 use cases)
*   Thiết kế kiến trúc tổng thể (3-tier architecture)
*   Thiết kế cơ sở dữ liệu (32 tables, 15+ indexes)
*   Thiết kế API (150+ endpoints)
*   State machines (TinDang, CuocHen, Coc, HopDong)
*   UI/UX design (wireframes, design system)
*   Thiết kế chuyên sâu cho Trợ lý cuộc hẹn, eKYC đa tầng và VideoCall dịch thời gian thực

**Chương 4 - Triển khai hệ thống:**

*   Environment setup và dependencies
*   Implementation details cho từng module (Authentication, Tin đăng, Cuộc hẹn, Đặt cọc, Hợp đồng, Chat, Dashboard)
*   Real-time features với Socket.IO
*   Payment integration với SePay
*   Geocoding với Google Maps API
*   Tích hợp eKYC, Trợ lý cuộc hẹn và VideoCall AI Translation

**Chương 5 - Kết quả và đánh giá:**

*   Kết quả triển khai (31/36 UCs hoàn thành)
*   Testing và validation (Unit tests, Integration tests, Manual testing)
*   Performance benchmarks (API response time, Search latency, Deposit end-to-end)
*   User feedback và case studies
*   Lessons learned

**Chương 6 - Kết luận và hướng phát triển:**

*   Tổng kết kết quả đạt được
*   Hạn chế hiện tại
*   Hướng phát triển tương lai (Security hardening, Mobile apps, AI/ML features, Blockchain integration)

**Phụ lục:**

*   A. Use Cases chi tiết
*   B. API Documentation
*   C. Database Schema (ERD)
*   D. Deployment Guide
*   E. User Manual
*   F. Code samples
